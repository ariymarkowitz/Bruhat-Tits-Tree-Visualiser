# Bruhat-Tits tree visualiser

https://ariymarkowitz.github.io/Bruhat-Tits-Tree-Visualiser/

This is a visualiser of the Bruhat-Tits tree over $\mathbb{Q}_p$, and the action of $\textrm{GL}(2, \mathbb{Q}_p$)$ on the tree.

<img src=https://github.com/ariymarkowitz/Bruhat-Tits-Tree-Visualiser/blob/master/images/canvas.png width='800px'>

# About the Bruhat-Tits tree

## p-adic numbers

There are a couple of ways of defining the $p$-adic numbers for a prine $p$. One way is to consider the rationals $\mathbb{Q}$, and use a different metric (notion of 'distance'). Informally, a pair of $p$-adic numbers $x$ and $y$ are 'close' to each other when $x-y$ is a multiple of a large power of $p$. We may then take the completion, similar to the real numbers, to give a field and metric space $\mathbb{Q}_p$.

The other way of describing the p-adic numbers is to consider them as the field of infinite expansions

$$a_{-m} p^{-m} + a_{-m+1} p^{-m+1} + \dots + a_0 p^0 + a_1 p^1 + a_1 p^2 \dots$$

This is similar to the base-$p$ expansion of a real number, however while real numbers can have infinitely many negative terms and finitely many positive terms, $p$-adic expansions can only have finitely many negative terms and may have infinitely many positive terms. The $p$-adic numbers in which all of the powers are nonnegative is called a *$p$-adic integer*, and the ring $\mathbb{Z}_p$ of $p$-adic integers is analogous to the integers in the field of rational numbers.

The $p$-adic numbers allow us to use the properties of metric spaces and geometry to explore number-theoretic properties.

## The Bruhat-Tits tree

The Bruhat-Tits tree is a way of visualising the actions of $\mathrm{GL}(2, K)$ (invertible 2x2 matrices over $K$), where $K$ is a local field. In this visualiser, we take $K$ to be $\mathbb{Q}_p$, the $p$-adic numbers for some prime $p$. (In actuality, we take $K = \mathbb{Q}$, the rational numbers, since we cannot express the irrational numbers in $\mathbb{Q}_p$ with finite precision.)

Let $V$ be the 2-dimensional vector space over $K$. A *lattice* is a subset of $V$ that is a free submodule of $\mathbb{Z}_p$ of rank 2; in other words, a subset of $V$ that is closed under linear combinations with coefficients in $\mathbb{Z}_p$, and is generated by 2 basis vectors. Lattices are similar to vector spaces, but there is an interesting difference: Lattices have sublattices, ie. submodules that are also of rank 2. Given a lattice $L$, $pL$ is both rank 2 and is properly contained in $L$ since $p$ does not have an inverse in $\mathbb{Z}_p$. In fact we have an infinite chain

$$L \supset pL \supset p^2L \supset \ldots$$

of lattices.

We find an interesting structure when we look at chains of maximal sublattices: $L/pL$ is isomorphic to the vector space $\mathbb{F}_p^2$ over the finite field $\mathbb{F}_p$, hence any lattice has exactly $p+1$ maximal sublattices. We may form a graph in which vertices are equivalence classes of lattices up to scalar multiplication, and vertices are adjacent if the vertices contain lattices $L$ and $L'$ respectively such that $L'$ is maximal in $L$. Fascinatingly, this graph turns out to be a tree! We call this the *Bruhat-Tits tree*.

Another way of viewing the tree is as a way of building a $p$-adic expansion. Each vertex contains a unique lattice $L$ generated by vectors $(1, u)$ and $(0, p^n)$ for some $n \in \mathbb{Z}$, $0 \leq u < p^n$, and since $(1, u)$ can be considered as the projective point corresponding to $u$, $L$ can be considered to be $u$ up to addition by ($p$-adic) integer multiples of $p^n$; in other words, $u \bmod p^n$. Hence the vertex can be identified with the $p$-adic expansion

$$
u_m p^{-m} + u_{m-1} p^{-m+1} + \dots + u_{n-1} p^{n-1}.
$$

We may write this similarly to decimal form; for example, 11.1 in $\mathbb{Q}_2$ is 3.5 in base 10. For finitely many digits, this is the same as base 2, however $p$-adic numbers may have infinitely many nonzero digits before the decimal point and finitely many after, while base-$p$ numbers may only have infinitely many nonzero digits after the decimal point and finitely many before. For example, $\dots 11111.0$ is written as -1 in base 10.

The neighbours of a vertex are the possible ways to add to the next term in the expansion, together with one neighbour that removes the last term in the expansion. For example, in the Bruhat-Tits tree over $\mathbb{Q}_2$ the vertex corresponding to $1.000\dots$ has neighbours $01.000\dots$,  $11.000\dots$, and $.000\dots$

Another way to put this is that the vertices represent p-adic numbers up to a certain number of digits of precision, and neighbours are the ways of changing the precision by 1 digit.

Note that two pieces of information are needed to represent a vertex: the $p$-adic integer $u$, and $n$ such that $p^n$ is the next term in the expansion. For example, the vertex $1 \times 2^0$ is different from the vertex $1 \times 2^0 + 0 \times 2^1$. We represent this as $[u]_n$ in the visualiser (this can be seen when hovering over a node).

## Isometries of the tree

Since the vertices are equivalence classes of lattices, the group $\mathrm{GL}(2, \mathbb{Q}_p)$ of invertible $2 \times 2$ matrices acts naturally on the tree by left multiplication. This action can be considered a discrete version of the isometries of the hyperbolic plane (which can be identified with $\mathrm{PGL}(2, \mathbb{R})$), and has similar properties. For example, there are two classes of isometries: *elliptic* isometries that fix at least one point, and *hyperbolic* isometries that do not fix any points. Hyperbolic isometries do stabilize a single axis, called the *translation axis*; these are the set of points translated the minimum amount. In Euclidean space, a translation moves all points the same distance. In hyperbolic space and on the Bruhat-Tits tree, points farther away from the translation axis will be moved a larger amount.

## Boundary of the tree

If each vertex is a finite $p$-adic expansion, then an infinite path can be associated with an infinite $p$-adic expansion. Hence we may identify the 'boundary' of the tree with the projective $p$-adic line. (The point at infinity corresponds to following the 'reverse' path $[0]_n$ as $n \to -\infty$). An infinite ray on the tree is called an 'end', and if we fix the starting point of the ray then each end corresponds to a unique point on the boundary. This is shown in the visualisation by the fact that neighbours farther from the origin are exponentially closer together, so that every infinite ray converges to a unique point. (One may draw an analogy to, or represent this directly with, the PoincarÃ© disk model of the hyperbolic plane.) Thus we can visualise the boundary of the tree. We see that $\mathrm{GL}(2, \mathbb{Q}_p)$ also acts on the projective $p$-adic line.

## Function fields

The Bruhat-Tits tree can also be defined over a the field $\mathbb{F}_p((x))$ of formal Laurent series (infinite power series, with finitely many terms with negative exponent) over a finite field. We define a similar metric to the $p$-adic numbers; in this case, power series $f(x)$ and $g(x)$ are 'close' when $f(x)-g(x)$ is a multiple of a large power of $x$.

The Laurent series and $p$-adic numbers have a lot of similarities, and together they classify the *non-Archimedean local fields*. The main factor that distinguishes them is their *characteristic*: The number of times you need to add 1 to itself to reach 0. The field of Laurent series $\mathbb{F}_p((x))$ has characteristic $p$. In $\mathbb{Q}_p$ you can add 1 to itself forever and never reach 0; for convenience we say that $\mathbb{Q}_p$ has characteristic 0.

# How to use the visualiser

## Inputs

- 'characteristic' chooses the characteristic of the field.
- 'p' sets the field. In characteristic 0 the field is $\mathbb{Q}_p$, while in characteristic $p$ the field is $\mathbb{F}_p((x))$.
- 'Depth' sets the depth of the tree (maximum distance rendered).
- 'End' shows an end of the tree (an infinite ray starting from the origin). The input may be an integer or rational number in characteristic 0, or a polynomial or rational function (like (1 + x^3) / 4x) in characteristic $p$. the input a/b corresponds to the projective point (b, a). 1/0 gives the end corresponding to the projective point at infinity.
- 'Isometry' shows the minimum translation set of the isometry induced by a given matrix. The inputs may be rational numbers in characteristic 0, or a rational function in characteristic p.

## Colour scheme

- The provided end is shown as a red ray starting from the origin.
- If an isometry is elliptic (fixes a vertex), then the fixed points are shown in blue.
- If an isometry is hyperbolic (translates every vertex), then the translation axis is shown in green.
- If the isometry fixes only the midpoint of an edge, then it will show the fixed point as a blue vertex.
- The image of the vertex being hovered over is coloured red.

## Other features

- Hovering over a vertex will show a tooltip displaying the vertex as $[u]_n$. This corresponds to the lattice generated by $(1, u)$ and $(0, p^n)$.
- Animation!
- You can also download an animation as a series of images. If you want a video or GIF, they can be stitched together using a program such as FFMPEG.
